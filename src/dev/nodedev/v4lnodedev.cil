;; SPDX-FileCopyrightText: Â© 2025 Dominick Grift <dominick.grift@defensec.nl>
;; SPDX-License-Identifier: Unlicense

(block v4l

  (filecon "/dev/media([0-9]+)?" char nodedev_context)
  (filecon "/dev/video([0-9]+)?" char nodedev_context)

  (macro getattr_nodedev_chr_files ((type ARG1))
         (allow ARG1 nodedev (chr_file (getattr))))

  (macro map_nodedev_chr_files ((type ARG1))
         (allow ARG1 nodedev (chr_file (map))))

  (macro setattr_nodedev_chr_files ((type ARG1))
         (allow ARG1 nodedev (chr_file (setattr))))

  (macro watch_nodedev_chr_files ((type ARG1))
         (allow ARG1 nodedev (chr_file (watch))))

  (blockinherit .nodedev.template)

  (call .rbacsep.exempt.obj.type (nodedev)))
